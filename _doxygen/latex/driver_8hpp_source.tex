\doxysection{driver.\+hpp}
\hypertarget{driver_8hpp_source}{}\label{driver_8hpp_source}\index{liblava/frame/driver.hpp@{liblava/frame/driver.hpp}}
\mbox{\hyperlink{driver_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{argh_8hpp}{liblava/frame/argh.hpp}}"{}}}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ \textcolor{keyword}{namespace\ }lava\ \{}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00017\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structlava_1_1stage_a825e08db257906413e57ce438e4fd887}{stage}}\ \{}
\DoxyCodeLine{00019\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{structlava_1_1stage_af9a5dffac53f1f39a6d201f775d40bb9}{map}}\ =\ std::map<index,\ stage*>;}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00022\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{structlava_1_1stage_a3696a5b9bb5ab7ff168ebf97804f8bb7}{func}}\ =\ std::function<\mbox{\hyperlink{types_8hpp_a7e5d7f16aff5126a54243302372b43b1}{i32}}(argh::parser)>;}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00030\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{structlava_1_1stage_a825e08db257906413e57ce438e4fd887}{stage}}(\mbox{\hyperlink{types_8hpp_ae3c4bbc50dd4583ab0df2c24c49a49c9}{ui32}}\ \textcolor{keywordtype}{id},}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{types_8hpp_a01c2a7bfa24e7ea76ef5a79d8d4daaf6}{string\_ref}}\ \mbox{\hyperlink{structlava_1_1stage_aa1f7cf27be9025a80d4a8b1dd9c9aaa4}{name}},}
\DoxyCodeLine{00032\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structlava_1_1stage_a3696a5b9bb5ab7ff168ebf97804f8bb7}{func}}\ \mbox{\hyperlink{structlava_1_1stage_a3696a5b9bb5ab7ff168ebf97804f8bb7}{func}});}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00035\ \ \ \ \ \mbox{\hyperlink{types_8hpp_a2a40eb7fccb1ebcfd58d6d4b7a078e5c}{index}}\ \textcolor{keywordtype}{id}\ =\ 0;}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00038\ \ \ \ \ \textcolor{keywordtype}{string}\ \mbox{\hyperlink{structlava_1_1stage_aa1f7cf27be9025a80d4a8b1dd9c9aaa4}{name}};}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00041\ \ \ \ \ \mbox{\hyperlink{structlava_1_1stage_a3696a5b9bb5ab7ff168ebf97804f8bb7}{func}}\ \mbox{\hyperlink{structlava_1_1stage_aa342228af68538573490437bb069fafc}{on\_func}};}
\DoxyCodeLine{00042\ \};}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00047\ \textcolor{keyword}{struct\ }driver\ \{}
\DoxyCodeLine{00051\ \ \ \ \ \textcolor{keyword}{enum}\ \mbox{\hyperlink{structlava_1_1driver_a46bcb3fcede1d91f250dd6bef15bba84}{error}}\ \{}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ stages\_empty\ =\ -\/1,}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ stage\_not\_found\ =\ -\/2,}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ undef\_run\ =\ -\/3,}
\DoxyCodeLine{00055\ \ \ \ \ \};}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structlava_1_1driver_1_1result}{result}}\ \{}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{types_8hpp_a7e5d7f16aff5126a54243302372b43b1}{i32}}\ \mbox{\hyperlink{structlava_1_1driver_1_1result_ab4445152ef711d9542259c4e4cf47ddb}{driver}}\ =\ 0;}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{types_8hpp_a7e5d7f16aff5126a54243302372b43b1}{i32}}\ \mbox{\hyperlink{structlava_1_1driver_1_1result_a56e124796b3f88e822bf24b79d4846c7}{selected}}\ =\ 0;}
\DoxyCodeLine{00066\ \ \ \ \ \};}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00072\ \ \ \ \ \textcolor{keyword}{static}\ driver\&\ \mbox{\hyperlink{structlava_1_1driver_ade12629f76d50f187860954ec93e5b15}{instance}}()\ \{}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ driver\ driver;}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ driver;}
\DoxyCodeLine{00075\ \ \ \ \ \}}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00081\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structlava_1_1driver_a10b1666387c2aac2ee2c3fcc0b56d87a}{add\_stage}}(\mbox{\hyperlink{structlava_1_1stage}{stage}}*\ \mbox{\hyperlink{structlava_1_1stage}{stage}})\ \{}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ assert(!m\_stages.count(\mbox{\hyperlink{structlava_1_1stage}{stage}}-\/>\mbox{\hyperlink{structlava_1_1stage_ad4bd99d638a787dba404c92e61d18de0}{id}})\ \&\&\ \textcolor{stringliteral}{"{}stage\ id\ already\ defined."{}});}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ m\_stages.emplace(\mbox{\hyperlink{structlava_1_1stage}{stage}}-\/>\mbox{\hyperlink{structlava_1_1stage_ad4bd99d638a787dba404c92e61d18de0}{id}},\ \mbox{\hyperlink{structlava_1_1stage}{stage}});}
\DoxyCodeLine{00084\ \ \ \ \ \}}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00090\ \ \ \ \ \mbox{\hyperlink{structlava_1_1stage_af9a5dffac53f1f39a6d201f775d40bb9}{stage::map}}\ \textcolor{keyword}{const}\&\ \mbox{\hyperlink{structlava_1_1driver_acd24daf28a3186453991f5ef1201e39e}{get\_stages}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ m\_stages;}
\DoxyCodeLine{00092\ \ \ \ \ \}}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00099\ \ \ \ \ \mbox{\hyperlink{types_8hpp_a7e5d7f16aff5126a54243302372b43b1}{i32}}\ \mbox{\hyperlink{structlava_1_1driver_a8d80fe8735c05b7a898439d1a6ca7da0}{run}}(argh::parser\ \mbox{\hyperlink{argh_8hpp_a0ec69c8269dd4598981cbfeea2cc88d1}{cmd\_line}}\ =\ \{\});}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00102\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{structlava_1_1driver_a17f884fcfa3e5acb85f36da82a5b9240}{run\_func}}\ =\ std::function<\mbox{\hyperlink{structlava_1_1driver_1_1result}{result}}(argh::parser)>;}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00105\ \ \ \ \ \mbox{\hyperlink{structlava_1_1driver_a17f884fcfa3e5acb85f36da82a5b9240}{run\_func}}\ \mbox{\hyperlink{structlava_1_1driver_aae9102b766adabd740bb293e26c7e60c}{on\_run}};}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00107\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00111\ \ \ \ \ driver()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00112\ }
\DoxyCodeLine{00114\ \ \ \ \ \mbox{\hyperlink{structlava_1_1stage_af9a5dffac53f1f39a6d201f775d40bb9}{stage::map}}\ m\_stages;}
\DoxyCodeLine{00115\ \};}
\DoxyCodeLine{00116\ }
\DoxyCodeLine{00117\ \}\ \textcolor{comment}{//\ namespace\ lava}}
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00120\ \textcolor{preprocessor}{\#define\ STAGE\_OBJ\ stage\_}}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00123\ \textcolor{preprocessor}{\#define\ STAGE\_FUNC\ \_stage}}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00126\ \textcolor{preprocessor}{\#define\ STR\_(n,\ m)\ n\#\#m}}
\DoxyCodeLine{00127\ }
\DoxyCodeLine{00129\ \textcolor{preprocessor}{\#define\ STR(n,\ m)\ STR\_(n,\ m)}}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00132\ \textcolor{preprocessor}{\#define\ LAVA\_STAGE(ID,\ NAME)\ \(\backslash\)}}
\DoxyCodeLine{00133\ \textcolor{preprocessor}{\ \ \ \ lava::i32\ STR(STAGE\_FUNC,\ ID)(argh::parser\ argh);\ \(\backslash\)}}
\DoxyCodeLine{00134\ \textcolor{preprocessor}{\ \ \ \ lava::stage\ STR(STAGE\_OBJ,\ ID)(ID,\ NAME,\ ::STR(STAGE\_FUNC,\ ID));\ \(\backslash\)}}
\DoxyCodeLine{00135\ \textcolor{preprocessor}{\ \ \ \ lava::i32\ STR(STAGE\_FUNC,\ ID)(argh::parser\ argh)}}

\end{DoxyCode}
